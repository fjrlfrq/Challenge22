<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/css/bootstrap.min.css"
        integrity="sha384-HSMxcRTRxnN+Bdg0JdbxYKrThecOKuH5zCYotlSAcp1+c8xmyTe9GYg1l9a69psu" crossorigin="anonymous">
    <link rel="stylesheet" href="./public/stylesh/style.css">
    <link rel="stylesheet" href="./public/fontawesome/css/all.css">
    <title>BREAD</title>
</head>

<body>

    <div class="card">

        <div class="card-header">
            <marquee behavior="ALTERNATE" scrollamount="8">
                <h2>BREAD (Browse,Read,Edit,Add,Delete)</h2>
            </marquee>
        </div>

        <div class="card-body">
            <div class="container">
                <form class="form-horizontal" id="search-form">
                    <input type="hidden" id="id" value="">
                    <div class="form-group">
                        <label class="col-sm-2" for="string">
                            <input type="checkbox" name="stringc"> String
                        </label>
                        <div class="col-sm-10">
                            <input type="text" class="form-control" placeholder="String" name="string" id="strings">
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-2" for="integer">
                            <input type="checkbox" name="integerc"> Integer
                        </label>
                        <div class="col-sm-10">
                            <input type="integer" class="form-control" placeholder="Integer" name="integer"
                                id="integers">
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-2" for="float">
                            <input type="checkbox" name="floatc"> Float
                        </label>
                        <div class="col-sm-10">
                            <input type="real" class="form-control" placeholder="Float" name="float" id="floats">
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-2" for="daten">
                            <input type="checkbox" name="datenc"> Date
                        </label>
                        <div class="col-sm-10">
                            <input type="date" class="form-control" placeholder="date" name="daten" id="datens">
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-2" for="boolean">
                            <input type="checkbox" name="booleanc"> Boolean
                        </label>
                        <div class="col-sm-10">
                            <input type="boolean" class="form-control" placeholder="Choose the boolean.." name="boolean"
                                id="booleans">
                        </div>
                    </div>
                    <div>
                        <button type="button" class="btn btn-info"><i class="fa-solid fa-magnifying-glass"></i></button>
                        <a href="/" class="btn btn-warning"><i class="fa-solid fa-rotate-left"></i></a>
                    </div>
                </form>
            </div>
        </div>

        <div class="card-body">
            <div class="container">
                <form class="form-horizontal" id="user-form">
                    <input type="hidden" id="id" value="">
                    <div class="form-group">
                        <label class="col-sm-2">
                            String
                        </label>
                        <div class="col-sm-10">
                            <input type="text" class="form-control" placeholder="String" name="string" id="string">
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-2">
                            Integer
                        </label>
                        <div class="col-sm-10">
                            <input type="integer" class="form-control" placeholder="Integer" name="integer"
                                id="integer">
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-2">
                            Float
                        </label>
                        <div class="col-sm-10">
                            <input type="real" class="form-control" placeholder="Float" name="float" id="float">
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-2">
                            Date
                        </label>
                        <div class="col-sm-10">
                            <input type="date" class="form-control" placeholder="date" name="daten" id="daten">
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-2">
                            Boolean
                        </label>
                        <div class="col-sm-10">
                            <input type="boolean" class="form-control" placeholder="Choose the boolean.." name="boolean"
                                id="boolean">
                        </div>
                    </div>
                    <div style="position: flex; text-align: end; padding-top:5mm">
                        <button type="submit" class="btn btn-info"><i class="fa-solid fa-download"></i></button>
                    </div>
                </form>
            </div>
        </div>

        <div class="card-body">
            <div class="container" style="padding-top: 0.5rem;">
                <form method="post">
                    <table class="table table-striped" style="text-align: center;">
                        <thead>
                            <tr>
                                <th>No</th>
                                <th><i class="fa-solid <%= %>"></i>  String</th>
                                <th><i class="fa-solid fa-sort"></i>  Integer</th>
                                <th><i class="fa-solid fa-sort"></i>  Float</th>
                                <th><i class="fa-solid fa-sort"></i>  Date</th>
                                <th>Boolean</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="users-body">

                        </tbody>
                    </table>

                    <div style="position: flex; text-align: center;">
                        <nav>
                            <ul class="pagination pagination-lg">
                                <li class="page-item">
                                    <a class="page-link" href="#" aria-label="Previous">
                                        <span aria-hidden="true">&laquo;</span>
                                        <span class="sr-only">Previous</span>
                                    </a>
                                </li>
                                <li class="page-item"><a class="page-link" href="">1</a></li>
                                <li class="page-item">
                                    <a class="page-link" href="#" aria-label="Next">
                                        <span aria-hidden="true">&raquo;</span>
                                        <span class="sr-only">Next</span>
                                    </a>
                                </li>
                            </ul>`
                        </nav>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script>
        document.getElementById("user-form").addEventListener("submit", function (event) {
            event.preventDefault()
            const id = document.getElementById('id').value
            const string = document.getElementById('string').value
            const integer = document.getElementById('integer').value
            const float = document.getElementById('float').value
            const daten = document.getElementById('daten').value
            const boolean = document.getElementById('boolean').value
            saveData(id, string, integer, float, daten, boolean)

        });

        const editData = (id) => {
            fetch(`http://localhost:3000/users/${id}`)
                .then((response) => response.json())
                .then((data) => {
                    document.getElementById('id').value = data._id
                    document.getElementById('string').value = data.string
                    document.getElementById('integer').value = data.integer
                    document.getElementById('float').value = data.float
                    document.getElementById('daten').value = data.daten
                    document.getElementById('boolean').value = data.boolean
                })
                .catch((error) => {
                    console.error('Error:', error);
                });
        }

        const readData = () => {
            fetch('http://localhost:3000/users')
                .then((response) => response.json())
                .then((data) => {
                    let html = ''
                    data.forEach((item, index) => {
                        html += `
                    <tr>
                        <td>${index + 1}</td>
                        <td>${item.string}</td>
                        <td>${item.integer}</td>
                        <td>${item.float}</td>
                        <td>${item.daten}</td>
                        <td>${item.boolean}</td>
                        <td>
                            <button type="button" class="btn btn-success" onclick="editData('${item._id}')"><i class="fa-solid fa-pen"></i></button>
                            <button type="button" class="btn btn-danger" onclick="removeData('${item._id}')"><i class="fa-solid fa-trash"></i></button>
                        </td>
                    </tr>
                    `
                    });

                    document.getElementById('users-body').innerHTML = html
                });
        }

        const saveData = (id, string, integer, float, daten, boolean) => {
            let url = 'http://localhost:3000/users'
            let method = 'POST'
            if (id) {
                url = `http://localhost:3000/users/${id}`
                method = 'PUT'
            }
            fetch(url, {
                method: method,
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ id, string, integer, float, daten, boolean }),
            }).then((response) => response.json()).then((data) => {
                document.getElementById('id').value = ''
                document.getElementById('string').value = ''
                document.getElementById('integer').value = ''
                document.getElementById('float').value = ''
                document.getElementById('daten').value = ''
                document.getElementById('boolean').value = ''
                readData()
            }).catch((error) => {
                console.error('Error:', error);
            });
        }

        const removeData = (id) => {
            if (confirm('anda yakin?')) {
                fetch(`http://localhost:3000/users/${id}`, {
                    method: 'DELETE',
                    headers: {
                        'Content-Type': 'application/json',
                    }
                })
                    .then((response) => response.json())
                    .then((data) => {
                        readData()
                    })
                    .catch((error) => {
                        console.error('Error:', error);
                    });
            }
        }

        readData();
    </script>

</body>

</html>